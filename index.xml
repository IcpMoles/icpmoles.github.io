<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mole of tales</title><link>https://icpmoles.github.io/</link><description>Recent content on Mole of tales</description><generator>Hugo -- gohugo.io</generator><language>en-en</language><lastBuildDate>Sat, 18 Nov 2023 21:44:03 +0100</lastBuildDate><atom:link href="https://icpmoles.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Static Preload</title><link>https://icpmoles.github.io/post/static-preload/</link><pubDate>Sat, 18 Nov 2023 21:44:03 +0100</pubDate><guid>https://icpmoles.github.io/post/static-preload/</guid><description>&lt;p>A simple method to calculate the static preload in a lumped body multi Degrees of Freedom system&lt;/p>
&lt;h2 id="tldr" clas=" mark rss xml">tl,dr:&lt;/h2>
&lt;aside class="notification-boxes" style="color:var(--t-blue);border-left-color:var(--blue);background:var(--c-blue); ">
&lt;span class="blocktitle" > Final Formula&lt;/span>&lt;br>
&lt;p> &lt;p>Given a system of \(s\) springs and \(n\) bodies in \(N\) degrees of freedom, we can calculate the static preload of our springs at equilibrium by:
$$ \vec {\Delta l_o} = [A]^{-1}[b] $$&lt;/p>
&lt;p>with \( \vec {\Delta l_o} \) as the vector of our \(s\) ordered solution, with&lt;/p>
&lt;p>$$ [A]=[\lambda_k]^T[k_{ph}]$$ and $$[b]=-g[\lambda_g]^T\vec m_{ph} $$&lt;/p>
&lt;p>\([\lambda_k]\) is our standard lagrangian matrix for the springs, \([\lambda_g]\) instead is built by selecting the components of vertical displacement from \([\lambda_m]\) (lagrangian matrix of the inertial terms) and \(\vec m_{ph}\) as the list of masses in column form.&lt;/p>
&lt;/p>
&lt;/aside>
&lt;h2 id="proof-1-dof-case" clas=" mark rss xml">Proof 1-DOF case&lt;/h2>
&lt;p>Let&amp;rsquo;s start by defining our problem. \(x\) is our free coordinate, so we have:&lt;/p>
&lt;p>$$ V(x) = V_k(x) + V_g(x) $$&lt;/p>
&lt;p>\(V\) is the potential energy of our system and it can be divided into an elastic component \( V_k \) and a gravitational component \( V_g \).&lt;/p>
&lt;p>The equilibrium is defined as the point \(x_0\) so that $$ \frac{\partial V}{\partial x}\rvert_{x_0}=0 $$
$$ \frac{\partial V_k}{\partial x}\rvert_{x_0}+\frac{\partial V_g}{\partial x}\rvert_{x_0}=0 $$&lt;/p>
&lt;p>To simplify our math let&amp;rsquo;s suppose that \(x_0=0\) (it&amp;rsquo;s a simple change of coordinates that will help in the N-dof case).&lt;/p>
&lt;p>The first step is to derive the components of the potential energy:&lt;/p>
&lt;h3 id="elastic-energy-1-dof" clas=" mark rss xml">Elastic energy 1-dof&lt;/h3>
&lt;p>\(V_k\) describes the energy stored in an ideal linear spring with Hooke&amp;rsquo;s coefficient \(k\) subject to a deformation \( \Delta l\)&lt;/p>
&lt;p>$$ V_k(x) = \sum_{i=1}^{s} \frac{1}{2} k_i \Delta l_i^2(x) $$&lt;/p>
&lt;p>We can ignore the index for now and express \( \Delta l (x)\) as \( \Delta l(x) = l(x) - l_r \), with \(l(x)\) as the total length of our spring and \(l_r\) as the initial length of the spring at resting position, thus giving us the convention of positive sign for tension and negative sign for compression of our spring.&lt;/p>
&lt;p>We can expand it as: $$ \Delta l(x) \approx \Delta l(0) + \frac{\partial \Delta l }{\partial x}\rvert_{x=0} x +\frac{1}{2}\frac{\partial^2 \Delta l }{\partial x^2}\rvert_{x=0} x^2 =\Delta l_0 + \lambda_k(0)x + \frac{1}{2}\nu_k(0)x^2 $$
when squared our second order components will become infinitesimal compared to the rest so we can ignore them.
$$ \Delta l(x)\rvert_{x=0} \approx \Delta l_0 + \lambda_k(0)x = \Delta l_0 + \lambda_{k0} x $$
When putting it back into the sum we get:&lt;/p>
&lt;p>$$ V_k(x) \rvert_{x=0} \approx \sum_{i=1}^{s} \frac{1}{2} k_i (\Delta l_{i0} + \lambda_{ik0} x )^2 = \sum_{i=1}^{s} \frac{1}{2} k_i (\Delta l_{i0}^2 + \lambda_{ik0}^2 x^2 + 2 \Delta l_{i0} \lambda_{ik0} x ) $$&lt;/p>
&lt;p>Let&amp;rsquo;s evaluate the derivative in respect to \(x\):&lt;/p>
&lt;p>\(\Delta l_0^2\) is a constant and gets eliminated by the derivative, the other sqare term becomes \(\lambda_{k0}^2 x\) and goes to zero when evaluated at \(x=0\), so only the mixed term \(2\Delta l_o \lambda_{k0} x\) survives and the derivative becomes:&lt;/p>
&lt;p>$$ \frac{\partial V_k }{\partial x}\rvert_{x=0}= \sum_{i=1}^s k_i \Delta l_{i0} \lambda_{ik0} $$&lt;/p>
&lt;p>We can rewrite this in vector form as:&lt;/p>
&lt;p>$$ [k_{ph}] = diag(k_1; k_2; &amp;hellip; ; k_s) $$&lt;/p>
&lt;p>$$ \vec {\Delta l_0 } = [ \Delta l_{10}; \Delta l_{20}; &amp;hellip; ; \Delta l_{s0}] $$&lt;/p>
&lt;p>$$ \vec \lambda_{k} = [\lambda_{1k};\lambda_{2k};&amp;hellip;;\lambda_{sk}] $$&lt;/p>
&lt;p>$$ \frac{\partial V_g(x)}{\partial x}\rvert_{x=0} = \vec \lambda_{k}^T [k_{ph}] \vec {\Delta l_0 } $$&lt;/p>
&lt;h3 id="gravitational-energy-1-dof" clas=" mark rss xml">Gravitational energy 1-dof&lt;/h3>
&lt;p>$$ V_g(x) = g \sum_{j=1}^n m_j h_j(x) $$&lt;/p>
&lt;p>This expresses the total gravitational energy in our system supposing \(n\) bodies with mass \(m_j\) and height \(h_j\) measured from an arbitrary system of coordinates.&lt;/p>
&lt;p>Applying the same concepts as the elastic term we get:&lt;/p>
&lt;p>$$ h(x)\rvert_{x=0} \approx h(x)\rvert_{0}+\frac{\partial h}{\partial x}\rvert_{0}x+\frac{1}{2}\frac{\partial^2 h}{\partial x^2}\rvert_{0} x^2 $$&lt;/p>
&lt;p>Let&amp;rsquo;s focus on the lower order terms and we get:&lt;/p>
&lt;p>$$ h(x)\rvert_{x=0} \approx h_{0}+\lambda_gx$$&lt;/p>
&lt;p>In this context \(\lambda_g\) is the linearized displacement of the height at equilibrium.&lt;/p>
&lt;p>$$ V_g(x) = g \sum_{j=1}^n m_j (h_{j0}+\lambda_{jg}x) $$&lt;/p>
&lt;p>Deriving it we get&lt;/p>
&lt;p>$$ \frac{\partial V_g(x)}{\partial x}\rvert_{x=0}=g \sum_{j=1}^n m_j \lambda_{jg} $$&lt;/p>
&lt;p>Let&amp;rsquo;s put everything in vector form&lt;/p>
&lt;p>$$ \vec {m_{ph}} = \begin{bmatrix}
m_1 \\ m_2 \\ \vdots \\ m_n
\end{bmatrix} $$&lt;/p>
&lt;p>$$ \vec \lambda_{g} =
\begin{bmatrix}
\lambda_{1g} \\ \lambda_{2g}\\ \vdots \\ \lambda_{ng}
\end{bmatrix}
$$&lt;/p>
&lt;p>$$ \frac{\partial V_g(x)}{\partial x}\rvert_{x=0} = g \vec \lambda_{g}^T \vec {m_{ph}} $$&lt;/p>
&lt;h3 id="final-expression" clas=" mark rss xml">Final expression&lt;/h3>
&lt;p>$$ \frac{\partial V_k}{\partial x}\rvert_{x_0}+\frac{\partial V_g}{\partial x}\rvert_{x_0}=0 $$&lt;/p>
&lt;p>$$ \vec \lambda_{k}^T [k_{ph}] \vec {\Delta l_0 } + g \vec \lambda_{g}^T \vec {m_{ph}} = 0 $$&lt;/p>
&lt;p>To find \( \vec {\Delta l_0 } \) we just rearrange it as:&lt;/p>
&lt;p>$$ \vec {\Delta l_0 } = -g(\vec \lambda_{k}^T [k_{ph}])^{-1} \vec \lambda_{g}^T \vec {m_{ph}} = [A]^{-1}\vec b $$&lt;/p>
&lt;h2 id="n-dof-case" clas=" mark rss xml">N-DOF case&lt;/h2>
&lt;p>We follow the same procedure but now we have additional dimensions for our \(\vec x\):&lt;/p>
&lt;p>$$ \vec x =
\begin{bmatrix}
x_1 \\ x_2 \\ \vdots \\ x_N
\end{bmatrix}
$$&lt;/p>
&lt;p>So we need to evaluate the gradient of our potential energy funcion for the equilibrium:&lt;/p>
&lt;p>$$ \frac{\partial V(\vec x)}{\partial \vec x}\rvert_{\vec x= \vec 0} =
\begin{bmatrix}
\frac{\partial V(\vec x)}{\partial x_1} \\
\frac{\partial V(\vec x)}{\partial x_2} \\
\vdots \\
\frac{\partial V(\vec x)}{\partial x_N}
\end{bmatrix}\rvert_{\vec x= \vec 0} =\vec 0$$&lt;/p>
&lt;p>$$ \nabla V(\vec x)\rvert_{\vec x= \vec 0} = \nabla V_k(\vec x)\rvert_{\vec x= \vec 0} + \nabla V_g(\vec x)\rvert_{\vec x= \vec 0} = \vec 0$$&lt;/p>
&lt;h3 id="elastic-energy" clas=" mark rss xml">Elastic energy&lt;/h3>
&lt;p>$$ V_k (\vec x)=\frac{1}{2}\sum_{i=1}^{s}k_i\Delta l_i^2(\vec x) =
\frac{1}{2} \vec{\Delta l_0}^T (\vec x) k_{ph} \vec{\Delta l_0(\vec x)}
$$&lt;/p>
&lt;p>with&lt;/p>
&lt;p>$$ k_{ph}=diag(k1,k2,&amp;hellip;,ks)$$
$$ \vec{\Delta l_0}(\vec x) = \begin{bmatrix}
\Delta l_{10}(\vec x) \\
\Delta l_{20}(\vec x) \\
\vdots \\
\Delta l_{N0}(\vec x)
\end{bmatrix}
$$&lt;/p>
&lt;p>As usual we expand our \(\Delta l(\vec x)\) near the equilibrium:&lt;/p>
&lt;p>$$ \vec{\Delta l(\vec x)} \rvert_{\vec x=\vec 0} \approx \vec {\Delta l(\vec 0)} + \frac{\partial \Delta l }{\partial \vec x}\rvert_{\vec x= \vec 0} \vec x +\frac{1}{2}\frac{\partial^2 \Delta l }{\partial x^2}\rvert_{\vec x= \vec 0} \vec x^2 = \vec{\Delta l_0} + [\lambda_k(0)]\vec x + \frac{1}{2}\vec x^T[\nu_k(0)]\vec x $$&lt;/p>
&lt;p>and we simplify it as:
$$ \vec{\Delta l(\vec x)}\rvert_{\vec x=\vec 0} \approx \vec{\Delta l_0} + [\lambda_k(0)] \vec x = \vec{\Delta l_0} + [\lambda_{k0}] \vec x $$&lt;/p>
&lt;p>Plugging it into the initial equation we get:&lt;/p>
&lt;p>$$ V_k (\vec x) \rvert_{\vec x=\vec 0} \approx
\frac{1}{2} (\vec {\Delta l_{0}} + [\lambda_{k0}] \vec x)^T [k_{ph}] (\vec {\Delta l_{0}} + [\lambda_{k0}] \vec x) = $$
$$ = \frac{1}{2}(
\vec x^T[\lambda_{k0}]^T [k_{ph}] [\lambda_{k0}] \vec x +
\vec {\Delta l_{0}}^T[k_{ph}] \vec {\Delta l_{0}} +
\vec {\Delta l_{0}}^T[k_{ph}] [\lambda_{k0}] \vec x +
\vec x^T[\lambda_{k0}]^T [k_{ph}] \vec {\Delta l_{0}} )
$$&lt;/p>
&lt;p>Like for our 1-DOF case the only terms that survive the gradient are the mixed ones:&lt;/p>
&lt;p>$$ \nabla V_k\rvert_{\vec x= \vec 0}= \frac{\partial V_k}{\partial \vec x} (\vec x) \rvert_{\vec x=\vec 0} \approx
\frac{1}{2} (\vec {\Delta l_{i0}}^T[k_{ph}] [\lambda_{ik0}] + [\lambda_{k0}]^T [k_{ph}] \vec {\Delta l_{0}} ) = [\lambda_{k0}]^T [k_{ph}] \vec {\Delta l_{0}}
$$&lt;/p>
&lt;h3 id="gravitational-energy" clas=" mark rss xml">Gravitational Energy&lt;/h3>
&lt;p>This must be straightforward now if you understood the past passages but for completeness let&amp;rsquo;s write them down:&lt;/p>
&lt;p>$$ V_g(\vec x) = g \vec h(\vec x)^T \vec {m_{ph}} $$&lt;/p>
&lt;p>with&lt;/p>
&lt;p>$$ \vec m_{ph}= \begin{bmatrix}
m_1 \\ m_2 \\ \vdots \\ m_n
\end{bmatrix} $$&lt;/p>
&lt;p>$$ \vec h(\vec x) = \begin{bmatrix}
h_1(\vec x) \\ h_2(\vec x) \\ \vdots \\ h_n(\vec x)
\end{bmatrix} $$&lt;/p>
&lt;p>Expanding the height we get:&lt;/p>
&lt;p>$$ \vec h(\vec x)\rvert_{\vec x=\vec 0} \approx \vec h(\vec x)\rvert_{\vec 0}+\frac{\partial \vec h}{\partial \vec x}\rvert_{\vec 0}\vec x+\frac{1}{2}\frac{\partial^2 h}{\partial \vec x \partial \vec x}\rvert_{\vec 0} \vec x^2 = \vec h_0 + [\lambda_k(0)]\vec x+ \frac{1}{2}\vec x^T[\nu_k(0)]\vec x$$&lt;/p>
&lt;p>Picking just the linear and terms we get:&lt;/p>
&lt;p>$$ \vec h(\vec x)\rvert_{\vec x=\vec 0} \approx \vec h_{0}+[\lambda_g]\vec x$$&lt;/p>
&lt;p>Transposing and putting it back in the original energy expression we get:&lt;/p>
&lt;p>$$ V_g(\vec x)\rvert_{\vec 0} = g ( \vec h_0^T + \vec x^T [\lambda_g]^T)\vec {m_{ph}} $$&lt;/p>
&lt;p>Deriving it we get&lt;/p>
&lt;p>$$ \nabla V_g\rvert_{\vec x= \vec 0} = \frac{\partial V_g(\vec x)}{\partial \vec x}\rvert_{x=0}=g [\lambda_g]^T \vec{m_{ph}} $$&lt;/p>
&lt;h3 id="final-formula" clas=" mark rss xml">Final formula&lt;/h3>
&lt;p>$$ \nabla V\rvert_{\vec x= \vec 0} = \nabla V_k\rvert_{\vec x= \vec 0} + \nabla V_g\rvert_{\vec x= \vec 0} = 0 $$&lt;/p>
&lt;p>$$ [\lambda_{k0}]^T [k_{ph}] \vec {\Delta l_{0}} = -g [\lambda_g]^T \vec{m_{ph}} $$&lt;/p>
&lt;p>$$[A]=[\lambda_{k0}]^T [k_{ph}] $$&lt;/p>
&lt;p>$$ \vec b = -g [\lambda_g]^T \vec{m_{ph}} $$&lt;/p>
&lt;p>$$ \vec {\Delta l_{0}} = [A]^{-1}\vec b $$&lt;/p></description></item><item><title>The unrequested GIF</title><link>https://icpmoles.github.io/post/gif-fallback/</link><pubDate>Tue, 05 Oct 2021 15:41:17 +0200</pubDate><guid>https://icpmoles.github.io/post/gif-fallback/</guid><description>&lt;p>While developing my GIF shortcode for Hugo I stumbled upon a weird behaviour from various browsers.&lt;/p>
&lt;p>The story&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> goes like: If you want to use videos instead of GIFs to save on bandwith for your users you can just use something like:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span> &lt;span style="color:#bc74c4">autoplay&lt;/span> &lt;span style="color:#bc74c4">loop&lt;/span> &lt;span style="color:#bc74c4">muted&lt;/span> &lt;span style="color:#bc74c4">playsinline&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.webm&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/webm&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.mp4&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/mp4&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">img&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.gif&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;/&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>&amp;lt;img src=&amp;quot;cat.gif&amp;quot;/&amp;gt;&lt;/code> will behave like a fallback for browsers not supporting the &lt;code>video&lt;/code> element or the provided formats. Just use ffmpeg to convert GIFs to MP4 and/or webm and you will have a couple of decades of video encoders developement to show animated cats in the fastest way possible.&lt;/p>
&lt;p>But no, even if your noble intents to show animated cats to your visitors while saving their bandwith seem completed there is a problem:&lt;/p>
&lt;p>With the code showed above &lt;mark>all the browsers will download the video file AND the gif file&lt;/mark>, throwing outside the window your bandwith saving intents and making it worse because you&amp;rsquo;re forcing your visitors to download an additional file, no matter how small it is.&lt;/p>
&lt;p>&lt;a href="https://www.w3schools.com/code/tryit.asp?filename=GV5OL2D67MVS">You can try it directly&lt;/a>&lt;/p>
&lt;p>
&lt;img alt="Notice the programming.gif file being downloaded before the video file" src="https://icpmoles.github.io/post/gif-fallback/devtools.png" />
&lt;/p>
&lt;p>As you see in the screen above the browser still downloads the &amp;ldquo;fallback&amp;rdquo; GIF.&lt;/p>
&lt;p>This behaviour doesn&amp;rsquo;t seem widely reported in the &amp;ldquo;use videos instead of gifs&amp;rdquo; guides, staying relegated to some StackOverflow discussions &lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>&lt;sup id="fnref:4">&lt;a href="#fn:4" class="footnote-ref" role="doc-noteref">4&lt;/a>&lt;/sup>.&lt;/p>
&lt;p>How should you resolve this?&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Don&amp;rsquo;t provide an &lt;code>&amp;lt;img&amp;gt;&lt;/code>, just link to the GIF and ask them to update the browser to something more &amp;ldquo;modern&amp;rdquo;.&lt;sup id="fnref:5">&lt;a href="#fn:5" class="footnote-ref" role="doc-noteref">5&lt;/a>&lt;/sup>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span> &lt;span style="color:#bc74c4">autoplay&lt;/span> &lt;span style="color:#bc74c4">loop&lt;/span> &lt;span style="color:#bc74c4">muted&lt;/span> &lt;span style="color:#bc74c4">playsinline&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.webm&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/webm&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.mp4&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/mp4&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">p&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>In case you browser doesn&amp;#39;t support video files open the &lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">a&lt;/span> &lt;span style="color:#bc74c4">target&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;_blank&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">href&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.gif&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>GIF&lt;span style="color:#56b6c2">&amp;lt;/&lt;/span>&lt;span style="color:#bc74c4">a&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span> in another page&lt;span style="color:#56b6c2">&amp;lt;/&lt;/span>&lt;span style="color:#bc74c4">p&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;/&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Fix stuff server side, check the UA and provide the &lt;code>&amp;lt;video&amp;gt;&lt;/code> instead of the &lt;code>&amp;lt;img&amp;gt;&lt;/code> or viceversa depending on it. If your content is statically rendered then it won&amp;rsquo;t work.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The &lt;code>&amp;lt;!--[if lt IE 9]&amp;gt;&lt;/code>&lt;sup id="fnref:6">&lt;a href="#fn:6" class="footnote-ref" role="doc-noteref">6&lt;/a>&lt;/sup>. This will work because the only main browsers not supporting the &lt;code>video&lt;/code> elements are the &lt;a href="https://caniuse.com/video">Internet Explorer previous to the 9th and Opera Mini&lt;/a>. Your code will just be&lt;br>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span> &lt;span style="color:#bc74c4">autoplay&lt;/span> &lt;span style="color:#bc74c4">loop&lt;/span> &lt;span style="color:#bc74c4">muted&lt;/span> &lt;span style="color:#bc74c4">playsinline&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.webm&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/webm&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;&lt;/span>&lt;span style="color:#bc74c4">source&lt;/span> &lt;span style="color:#bc74c4">src&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;cat.mp4&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">type&lt;/span>&lt;span style="color:#bc74c4">=&lt;/span>&lt;span style="color:#82cc6a">&amp;#34;video/mp4&amp;#34;&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#3e4460">&amp;lt;!--[if lt IE 9]&amp;gt;&amp;lt;img src=&amp;#34;cat.gif&amp;#34;/&amp;gt;&amp;lt;![endif]--&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#56b6c2">&amp;lt;/&lt;/span>&lt;span style="color:#bc74c4">video&lt;/span>&lt;span style="color:#56b6c2">&amp;gt;&lt;/span> &lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>No GIF fallback. Really. At the time of writing those IE versions account for a 0,06% of the broswer share. Opera Mini is a bit more used (1,19%) but I think that CanIUse uses the UA to calculate the browser usage regardless of the type of data saving enabled, while for the tests it uses the aggressive server rendering option. In the worst case scenario the 1,25% of your visitors will have a degraded experience without the animated cats. Being more realistics I will say that even before the lack of animated cats those 1,25% will have a bad time in 2021 to reach your website between expired certificates, unsupported protocols, etc. (Try downloading an &lt;a href="https://ftp.mozilla.org/pub/firefox/releases/">old Firefox&lt;/a> version to see it by yourself).&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>&lt;a href="https://www.smashingmagazine.com/2018/11/gif-to-video/">Improve Animated GIF Performance With HTML5 Video&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>&lt;a href="https://rigor.com/blog/optimizing-animated-gifs-with-html5-video/#:~:text=to%20use%20our%20new%20video%2C%20we%20need%20to%20replace%20that%20with%20this%3A">Optimizing Animated GIFs by Converting to HTML5 Video&lt;/a>&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>&lt;a href="https://stackoverflow.com/questions/26365401/html5-fallback-images-are-being-loaded-by-the-browser-even-though-html5-video-i">HTML5 fallback images are being loaded by the browser, even though HTML5 video is supported&lt;/a>&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:4">
&lt;p>&lt;a href="https://stackoverflow.com/questions/63108518/best-practices-to-fall-back-to-gif-for-browsers-that-dont-support-html-5-video#:~:text=note%3A%20in%20my%20browser%20at%20least%2C%20the%20image%20inside%20is%20still%20fetched%20and%20loaded">&amp;ldquo;Note: In my browser at least, the image inside is still fetched and loaded&amp;rdquo;&lt;/a>&amp;#160;&lt;a href="#fnref:4" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:5">
&lt;p>&lt;a href="https://cloudinary.com/blog/reduce_size_of_animated_gifs_automatically_convert_to_webm_and_mp4#html5_video_tag_with_mp4_and_webm_sources">Reducing the Size of Animated GIFs and Converting Them to WebM or MP4 Through Automation&lt;/a>&amp;#160;&lt;a href="#fnref:5" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:6">
&lt;p>&lt;a href="https://stackoverflow.com/a/49809226">Keenly on StackOverflow&lt;/a>&amp;#160;&lt;a href="#fnref:6" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Enable DoH when Chrome is managed</title><link>https://icpmoles.github.io/post/chrome-doh/</link><pubDate>Fri, 07 May 2021 09:03:07 +0000</pubDate><guid>https://icpmoles.github.io/post/chrome-doh/</guid><description>&lt;p>For whatever reason your browser is locked out from changing the &lt;abbr title="DNS over HTTPS">DoH&lt;/abbr> settings? Here is how to change the settings if you have admin permissions.&lt;/p>
&lt;p>It happened to me to buy a new laptop. This laptop comes with all the usual OEM stuff to manage security and updates. One of those software scans every downloaded file and marks its origin. To do that the software enables the &lt;code>GroupPolicyUsers&lt;/code> and installs an extension.&lt;/p>
&lt;p>Ok, cool but now whenever I want to change some Chrome (or even Firefox) settings I&amp;rsquo;m greeted with this message:&lt;/p>
&lt;p>
&lt;img alt="" src="https://icpmoles.github.io/post/chrome-doh/admin_warning.png" />
&lt;/p>
&lt;p>Since I wanted to use my NextDNS account I had to fix this.&lt;/p>
&lt;p>First try was removing the User Policy by using a simble bash script found somewhere online&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#c9c9c9;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1&lt;/span>&lt;span>@echo off
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3&lt;/span>&lt;span>IF NOT EXIST %WINDIR%&lt;span style="color:#56b6c2">\\&lt;/span>System32&lt;span style="color:#56b6c2">\\&lt;/span>GroupPolicy goto next
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5&lt;/span>&lt;span>&lt;span style="color:#7fbaf5">echo&lt;/span> Deleting GroupPolicy folder...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6&lt;/span>&lt;span>RD /S /Q &lt;span style="color:#82cc6a">&amp;#34;%WINDIR%\\System32\\GroupPolicy&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">||&lt;/span> goto error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7&lt;/span>&lt;span>echo.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9&lt;/span>&lt;span>:next
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10&lt;/span>&lt;span>IF NOT EXIST %WINDIR%&lt;span style="color:#56b6c2">\\&lt;/span>System32&lt;span style="color:#56b6c2">\\&lt;/span>GroupPolicyUsers goto next2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12&lt;/span>&lt;span>&lt;span style="color:#7fbaf5">echo&lt;/span> Deleting GroupPolicyUsers folder...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13&lt;/span>&lt;span>RD /S /Q &lt;span style="color:#82cc6a">&amp;#34;%WINDIR%\\System32\\GroupPolicyUsers&amp;#34;&lt;/span> &lt;span style="color:#bc74c4">||&lt;/span> goto error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14&lt;/span>&lt;span>echo.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16&lt;/span>&lt;span>:next2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17&lt;/span>&lt;span>gpupdate /force
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19&lt;/span>&lt;span>pause
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20&lt;/span>&lt;span>&lt;span style="color:#7fbaf5">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22&lt;/span>&lt;span>:error
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23&lt;/span>&lt;span>echo.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24&lt;/span>&lt;span>&lt;span style="color:#7fbaf5">echo&lt;/span> An unexpected error has occurred. ¨Have opened the program as an administrator &lt;span style="color:#bc74c4">(&lt;/span>right click, run as administrator&lt;span style="color:#bc74c4">)&lt;/span>?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25&lt;/span>&lt;span>echo.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26&lt;/span>&lt;span>pause
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27&lt;/span>&lt;span>exit&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>Look at all the delete folder commands so close to &lt;code>System32&lt;/code>, that absolutely doesn&amp;rsquo;t make nervous.&lt;/p>
&lt;p>But this resetted at every boot. A more robust soultion was needed.&lt;/p>
&lt;p>Removing the OEM security software? I was afraid of breaking some weird software integration with the fingerprint and boot security software. 😅&lt;/p>
&lt;p>Now the final solution: If you can&amp;rsquo;t remove the User Policy use it.&lt;/p>
&lt;p>Looking up about the various admin policies on the &lt;a href="https://cloud.google.com/docs/chrome-enterprise/policies/?policy=DnsOverHttpsMode">Google Chrome&lt;/a> website it&amp;rsquo;s possibile to find the ones useful for us: &lt;code>DnsOverHttpsMode&lt;/code> and &lt;code>DnsOverHttpsTemplates&lt;/code>.&lt;/p>
&lt;p>Just set &lt;code>DnsOverHttpsMode&lt;/code> to &lt;code>secure&lt;/code> or &lt;code>automatic&lt;/code> depending if you want it to not have an insecure fallback.&lt;/p>
&lt;p>Then &lt;code>DnsOverHttpsTemplates&lt;/code> you need to fill your DoH provider.&lt;/p>
&lt;p>The &lt;a href="https://chromeenterprise.google/policies/#DnsOverHttpsTemplates">Chrome Policy&lt;/a> is a bit confusing but you just need to take the &lt;code>https&lt;/code> URL and add &lt;code>/dns-query{?dns}&lt;/code> after it (&lt;a href="https://tools.ietf.org/html/rfc8484#section-4.1.1">better explaination&lt;/a>).&lt;/p>
&lt;p>So if NextDNS provides you with &lt;code>https://dns.nextdns.io/123abc&lt;/code> your URL to fill is &lt;code>https://dns.nextdns.io/123abc/dns-query{?dns}&lt;/code>&lt;/p>
&lt;p>Here is a list of various DoH providers with everything already filled in:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Provider&lt;/th>
&lt;th>Standard&lt;/th>
&lt;th>Family Protection&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>AdGuard&lt;/td>
&lt;td>&lt;code>https://dns.adguard.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;td>&lt;code>https://dns-family.adguard.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Cloudflare&lt;/td>
&lt;td>&lt;code>https://cloudflare-dns.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;td>&lt;code>https://family.cloudflare-dns.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Google&lt;/td>
&lt;td>&lt;code>https://dns.google/dns-query{?dns}&lt;/code>&lt;/td>
&lt;td>NA&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>OpenDNS&lt;/td>
&lt;td>&lt;code>https://doh.opendns.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;td>&lt;code>https://doh.familyshield.opendns.com/dns-query{?dns}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Quad9&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/td>
&lt;td>&lt;code>https://dns.quad9.net/dns-query{?dns}&lt;/code>&lt;/td>
&lt;td>NA&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Bot how to enable it? You can edit manual through &lt;code>regedit&lt;/code> or you can copy this code in a new file and save it with a &lt;code>.reg&lt;/code> extension. You can directly insert your DNS of choice in place of the default Google one.&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-linenos=inline" data-lang="linenos=inline">Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Google\Chrome]
&amp;#34;DnsOverHttpsTemplates&amp;#34;=&amp;#34;https://dns.google/dns-query{?dns}&amp;#34;
&amp;#34;DnsOverHttpsMode&amp;#34;=&amp;#34;automatic&amp;#34;&lt;/code>&lt;/pre>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Be aware that they provide different hostnames with different features like ECS etc. &lt;a href="https://www.quad9.net/news/blog/doh-with-quad9-dns-servers/#:~:text=quad9%20supports%20three%20flavors%20of%20dns%20currently.">Quad9&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Hugo rendering: Github Pages vs Netlify vs Cloudflare Pages</title><link>https://icpmoles.github.io/post/hosting-comparisons/</link><pubDate>Tue, 04 May 2021 20:07:30 +0000</pubDate><guid>https://icpmoles.github.io/post/hosting-comparisons/</guid><description>&lt;p>Given the various choices of hosting for your static files you may be unsure which one to pick.
These are the features and performances of the top three services with their free tier.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Features&lt;/th>
&lt;th>Github Pages&lt;/th>
&lt;th>Cloudflare Pages&lt;/th>
&lt;th>Netflify&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Multiple subomains&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/td>
&lt;td>❌&lt;/td>
&lt;td>Max 10&lt;/td>
&lt;td>Infinite&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Custom subdomains&lt;/td>
&lt;td>Fixed to [github username].github.io&lt;/td>
&lt;td>Fixed to [github repo name].pages.dev&lt;/td>
&lt;td>*.netlify.app&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Ease of Setup&lt;/td>
&lt;td>Low&lt;/td>
&lt;td>High&lt;/td>
&lt;td>High&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>SSLlabs score&lt;/td>
&lt;td>A&lt;/td>
&lt;td>B&lt;/td>
&lt;td>A&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Byte Serving for video&lt;/td>
&lt;td>✅&lt;/td>
&lt;td>❌ &lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>&lt;/td>
&lt;td>✅&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Monthly Bandwith&lt;/td>
&lt;td>100GB&lt;/td>
&lt;td>n/a&lt;/td>
&lt;td>100GB&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Builds limits&lt;/td>
&lt;td>10 builds per hour&lt;/td>
&lt;td>500 times per month&lt;/td>
&lt;td>300 minutes per month&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Maximum file size&lt;/td>
&lt;td>100 MB&lt;/td>
&lt;td>25 MB&lt;/td>
&lt;td>n/a&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Storage Size&lt;/td>
&lt;td>5 GB&lt;/td>
&lt;td>n/a&lt;/td>
&lt;td>100 GB&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Build Previews&lt;/td>
&lt;td>❌&lt;/td>
&lt;td>✅&lt;/td>
&lt;td>✅&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Test Build: Hugo&lt;/td>
&lt;td>1597 ms&lt;/td>
&lt;td>1320 ms&lt;/td>
&lt;td>1852 ms&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Test Build: Total&lt;/td>
&lt;td>33s&lt;/td>
&lt;td>58s&lt;/td>
&lt;td>40s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Download times: 4.252 Kb HTML &lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>&lt;/td>
&lt;td>239 ms&lt;/td>
&lt;td>245ms&lt;/td>
&lt;td>492 ms&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>As you can see from the table and from the graph, downloading the test file usually takes 200-250ms on Github Pages and Cloudflare, while on Netlify the times as 2 times longer with a more unreliable time for the latter.&lt;/p>
&lt;iframe title="Time for each request" aria-label="Interactive line chart" id="datawrapper-chart-IlvdX" src="https://datawrapper.dwcdn.net/IlvdX/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="400" loading="lazy">&lt;/iframe>&lt;script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"])for(var e in a.data["datawrapper-height"]){var t=document.getElementById("datawrapper-chart-"+e)||document.querySelector("iframe[src*='"+e+"']");t&amp;&amp;(t.style.height=a.data["datawrapper-height"][e]+"px")}}))}();
&lt;/script>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>All three offer you to use your own domain name.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>Probably they do it to avoid abuse and to not compete with the &lt;a href="https://www.cloudflare.com/products/cloudflare-stream/">Cloudflare Stream&lt;/a> products.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>Average of 200 tests with &lt;a href="https://github.com/reorx/httpstat">httpstat&lt;/a> against a &lt;a href="./lorem">test page&lt;/a>&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>How does this blog work?</title><link>https://icpmoles.github.io/post/blog-backend/</link><pubDate>Tue, 30 Mar 2021 14:52:08 +0000</pubDate><guid>https://icpmoles.github.io/post/blog-backend/</guid><description>&lt;p>Have you ever wondered how this blog is setup?&lt;/p>
&lt;p>
&lt;img alt="1 - Backend" src="https://icpmoles.github.io/post/blog-backend/new.jpg" title="Diagram of the backend for the blog" />
&lt;/p></description></item><item><title>Credits</title><link>https://icpmoles.github.io/credits/</link><pubDate>Sun, 04 Oct 2020 22:00:00 +0000</pubDate><guid>https://icpmoles.github.io/credits/</guid><description>&lt;p>&lt;a href="https://gohugo.io">Hugo&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://github.com/azmelanar/hugo-theme-pixyll">Pixyll Theme&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.nordtheme.com">Nord Palette&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://sharingbuttons.io">SharingButtons.io&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://expando.github.io">Expando&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://forestry.io">Forestry&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://amp.dev">AMP&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://fonts.google.com">Google Fonts&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.mathjax.org">MathJax&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://staticman.net">Staticman&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.heroku.com">Heroku&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://feathericons.com/">Feather Icons&lt;/a>&lt;/p></description></item><item><title>Privacy Policy</title><link>https://icpmoles.github.io/privacy-policy/</link><pubDate>Sat, 22 Aug 2020 22:00:00 +0000</pubDate><guid>https://icpmoles.github.io/privacy-policy/</guid><description>&lt;p>This blog doesn&amp;rsquo;t collect analytics of any sort by it&amp;rsquo;s own. The blog relies on third party services to work properly:&lt;/p>
&lt;h2 id="github-pages" clas=" mark rss xml">GitHub Pages&lt;/h2>
&lt;p>I host this blog on GitHub Pages (hosted and controlled by Microsoft) which has its &lt;a href="https://docs.github.com/en/github/site-policy/github-privacy-statement#github-pages">own privacy policy&lt;/a>.&lt;/p>
&lt;p>Up until August 2020 they described it as follows:&lt;/p>
&lt;blockquote>
&lt;p>If you create a GitHub Pages website, it is your responsibility to post a privacy statement that accurately describes how you collect, use, and share personal information and other visitor information, and how you comply with applicable data privacy laws, rules, and regulations. &lt;em>Please note that GitHub may collect User Personal Information from visitors to your GitHub Pages website, including logs of visitor IP addresses&lt;/em>, to comply with legal obligations, and to maintain the security and integrity of the Website and the Service.&lt;/p>
&lt;/blockquote>
&lt;h2 id="amp" clas=" mark rss xml">AMP&lt;/h2>
&lt;p>Another issue is given by AMP (hosted and controlled by Google), which is only used in the AMP version of the blog (it activates automatically if you arrive from external services that support it). As specified on the footnote of &lt;a href="https://amp.dev/">their website:&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>The services available at cdn.ampproject.org are provided by Google and the respective privacy policy applies.&lt;/p>
&lt;/blockquote>
&lt;p>Up until August 2020 on Google&amp;rsquo;s main website &lt;a href="https://policies.google.com/privacy?hl=en">their privacy policy&lt;/a> specified:&lt;/p>
&lt;blockquote>
&lt;h3 id="information-we-collect-as-you-use-our-services" clas=" mark rss xml">Information we collect as you use our services&lt;/h3>
&lt;h4 id="your-apps-browsers--devices" clas=" mark rss xml">Your apps, browsers &amp;amp; devices&lt;/h4>
&lt;p>We collect information about the apps, browsers, and devices you use to access Google services, which helps us provide features like automatic product updates and dimming your screen if your battery runs low.&lt;/p>
&lt;p>&lt;em>The information we collect includes unique identifiers, browser type and settings, device type and settings, operating system, mobile network information including carrier name and phone number, and application version number. We also collect information about the interaction of your apps, browsers, and devices with our services, including IP address, crash reports, system activity, and the date, time, and referrer URL of your request.&lt;/em>&lt;/p>
&lt;p>We collect this information when a Google service on your device contacts our servers — for example, when you install an app from the Play Store or when a service checks for automatic updates. If you’re using an Android device with Google apps, your device periodically contacts Google servers to provide information about your device and connection to our services. This information includes things like your device type, carrier name, crash reports, and which apps you&amp;rsquo;ve installed.&lt;/p>
&lt;h4 id="your-activity" clas=" mark rss xml">Your activity&lt;/h4>
&lt;p>We collect information about your activity in our services, which we use to do things like recommend a YouTube video you might like. The activity information we collect may include:&lt;/p>
&lt;ul>
&lt;li>Terms you search for&lt;/li>
&lt;li>Videos you watch&lt;/li>
&lt;li>Views and interactions with content and ads&lt;/li>
&lt;li>Voice and audio information when you use audio features&lt;/li>
&lt;li>Purchase activity&lt;/li>
&lt;li>People with whom you communicate or share content&lt;/li>
&lt;li>&lt;em>Activity on third-party sites and apps that use our services&lt;/em>&lt;/li>
&lt;li>Chrome browsing history you’ve synced with your Google Account&lt;/li>
&lt;/ul>
&lt;p>If you use our services to make and receive calls or send and receive messages, we may collect telephony log information like your phone number, calling-party number, receiving-party number, forwarding numbers, time and date of calls and messages, duration of calls, routing information, and types of calls.&lt;/p>
&lt;p>You can visit your Google Account to find and manage activity information that’s saved in your account.&lt;/p>
&lt;/blockquote>
&lt;h2 id="staticman--heroku" clas=" mark rss xml">Staticman + Heroku&lt;/h2>
&lt;p>To provide a comment section I use a combination of Staticman hosted on a free instance of Heroku. The comments are rendered with the page and they won&amp;rsquo;t hit external websites. When sending a comment you will include a mail (it&amp;rsquo;s not checked and won&amp;rsquo;t be used to contact you but is used as a precaution to prevent abuse) and it will be stored as a MD5 hash for unique identification. When sending the comment your request is redirected to an external hosting service that will handle the inclusion of your comment on the website. Heroku will not store any passing data.&lt;/p>
&lt;h2 id="other-third-parties" clas=" mark rss xml">Other third parties&lt;/h2>
&lt;p>In case of embedded content your browser is also subject to other services with different privacy policies. The blog is configured to request the most basic and privacy preserving version of the embedded content that it supports. &lt;a href="https://gohugo.io/about/hugo-and-gdpr/">To discover more check the CMS page about it.&lt;/a>.&lt;/p>
&lt;p>The site is configured to use the strictest referrer policy possible when linking to external websites when possible.&lt;/p>
&lt;p>All the social sharing buttons work without the libraries provided by them, they just link to internal URLs of the various platforms.&lt;/p>
&lt;p>For services of Web tipping (Flattr, Brave Rewards) that rely on the browser (or an extension) recognizing a meta tag in the code of the blog and then reporting the usage statistics to their infrastructure, it&amp;rsquo;s specified in their privacy policy that they store locally information about your interaction with the website and then send this information in anonymized form. You can learn more in their respective websites: &lt;a href="https://flattr.com/privacy#:~:text=Your%20browsing%20behavior%20in%20the%20Extension">Flattr&lt;/a>, &lt;a href="https://brave.com/publishers-creators-privacy/">Brave Rewards&lt;/a>.&lt;/p>
&lt;p>This blog also uses local storage and service workers to provide offline functionality. All the work is done locally and it won&amp;rsquo;t download content that has not been asked to. This content will not be used to track or fingerprint users.&lt;/p></description></item><item><title>About</title><link>https://icpmoles.github.io/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://icpmoles.github.io/about/</guid><description>&lt;p>It&amp;rsquo;s me&lt;/p>
&lt;p>The blog is still under construction.&lt;/p></description></item><item><title>Contact</title><link>https://icpmoles.github.io/contact/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://icpmoles.github.io/contact/</guid><description>&lt;p>You can contact me on the various services listed on &lt;a href="https://keybase.io/icpmoles">Keybase.io&lt;/a>&lt;/p></description></item><item><title>Posts Archive</title><link>https://icpmoles.github.io/archives/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://icpmoles.github.io/archives/</guid><description/></item><item><title>Tags</title><link>https://icpmoles.github.io/taglist/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://icpmoles.github.io/taglist/</guid><description/></item></channel></rss>