<!doctype html><html lang=en-en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>How to setup ROS Noetic in WSL through Ubuntu 20.04 Focal | Mole of Moles</title>
<link rel=stylesheet href=../../css/bundle.min.0a14cfdc4b64bc262d2ecc858d625d56b10ea2b63a31d1b26eb1b604ae6dc9d4.css integrity="sha256-ChTP3EtkvCYtLsyFjWJdVrEOorY6MdGybrG2BK5tydQ=" crossorigin=anonymous><script type=module src=https://icpmoles.github.io/js/relative-time-element.min.js integrity></script></head><body><header><h1>N<sub>A</sub> of Moles</h1><nav><ul><li><a href=../../>Home</a></li><li><a aria-current=true class=ancestor href=../../posts/>Posts</a></li><li><a href=../../tags/>Tags</a></li></ul></nav></header><main><article><h1>How to setup ROS Noetic in WSL through Ubuntu 20.04 Focal</h1><time datetime=2024-02-28T20:01:43+01:00>February 28, 2024</time><p>Guide for the <a href="http://chrome.deib.polimi.it/index.php?title=Robotics">Robotics class</a></p><p>Scope: to install the environment needed for the labs without having to deal with Docker or dual booting in Ubuntu.</p><p>Target: PCs running Windows 10 or up supporting virtualization.</p><h2 id=basic-installation><a class="anchor mark-html" href=#basic-installation>Basic Installation</a></h2><p>First you need to set-up WSL in your machine. From a <strong>Windows</strong> command line run:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>powershell</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=n>update</span>
</span></span><span class=line><span class=cl><span class=n>wsl</span> <span class=n>install</span> <span class=n>Ubuntu</span><span class=p>-</span><span class=mf>20.04</span></span></span></code></pre></div></div><p>And fill the username and password as you please.</p><p>Now you should get a linux shell, in other case you can launch it from the start menu (simply search Ubuntu, it should also apper in the recently installed section) or from the dropdown menu of the terminal (my suggested method).</p><p>Let&rsquo;s update some packages as a precaution and then continue.</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt upgrade -y</span></span></code></pre></div></div><p>n.b: If you&rsquo;re using the internal PoliMi Wifi you may get some errors, simply switching the Wifi from &ldquo;Public Network&rdquo; to &ldquo;Private Network&rdquo; should fix it. You may have to change it back once you&rsquo;re done with this tutorial.</p><p>Now we start dealing with the core ROS installation. These commands are taken from the <a href=https://github.com/osrf/docker_images/blob/df19ab7d5993d3b78a908362cdcd1479a8e78b35/ros/noetic/ubuntu/focal/ros-core/Dockerfile>Docker repository</a></p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update 
</span></span><span class=line><span class=cl>sudo apt-get install -q -y --no-install-recommends dirmngr gnupg2
</span></span><span class=line><span class=cl>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
</span></span><span class=line><span class=cl>sudo  sh -c <span class=s1>&#39;echo &#34;deb http://packages.ros.org/ros/ubuntu focal main&#34; &gt;&gt; /etc/apt/sources.list.d/ros1-latest.list&#39;</span>
</span></span><span class=line><span class=cl>sudo apt-get update 
</span></span><span class=line><span class=cl>sudo apt-get install -y --no-install-recommends ros-noetic-ros-core<span class=o>=</span>1.5.0-1*
</span></span><span class=line><span class=cl><span class=nb>source</span> <span class=s2>&#34;/opt/ros/noetic/setup.bash&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;source /opt/ros/noetic/setup.bash&#34;</span> &gt;&gt; ~/.bashrc</span></span></code></pre></div></div><p>These are the commands for the &ldquo;base&rdquo; ROS installation taken from <a href=https://github.com/osrf/docker_images/blob/df19ab7d5993d3b78a908362cdcd1479a8e78b35/ros/noetic/ubuntu/focal/ros-base/Dockerfile>here</a></p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update 
</span></span><span class=line><span class=cl>sudo apt-get install --no-install-recommends -y  build-essential  python3-rosdep  python3-rosinstall   python3-vcstools 
</span></span><span class=line><span class=cl>sudo rosdep init 
</span></span><span class=line><span class=cl>rosdep update --rosdistro noetic
</span></span><span class=line><span class=cl>sudo apt-get update 
</span></span><span class=line><span class=cl>sudo apt-get install -y --no-install-recommends ros-noetic-ros-base<span class=o>=</span>1.5.0-1*</span></span></code></pre></div></div><p>Now finally for the &ldquo;perception&rdquo; ROS <a href=https://github.com/osrf/docker_images/blob/df19ab7d5993d3b78a908362cdcd1479a8e78b35/ros/noetic/ubuntu/focal/perception/Dockerfile>package</a></p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install -y --no-install-recommends   ros-noetic-perception<span class=o>=</span>1.5.0-1* </span></span></code></pre></div></div><p>Basically in the <code>Dockerfile</code> shared in class what we just did was simply the first section. <strong>This is not a command!!!!</strong></p><div class=codeblock><div class="codelang codeIcon">dockerfile</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># Start from the ROS Noetic perception image</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> ros:noetic-perception</span></span></span></code></pre></div></div><p>Now we continue with the other installation commands:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install -y --no-install-recommends nano vim tmux gedit ros-noetic-rqt* net-tools iproute2 ros-noetic-plotjuggler* ros-noetic-foxglove-bridge ros-noetic-turtlesim ros-noetic-tf*</span></span></code></pre></div></div><h2 id=update-for-lesson-7-and-onwards><a class="anchor mark-html" href=#update-for-lesson-7-and-onwards>Update for lesson 7 and onwards</a></h2><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install -y --no-install-recommends  ros-noetic-stage* ros-noetic-gmapping ros-noetic-slam-toolbox* ros-noetic-move-base* ros-noetic-amcl ros-noetic-global-planner ros-noetic-dwa-local-planner ros-noetic-navfn ros-noetic-turtlebot3-* ros-noetic-teleop-twist-keyboard ros-noetic-pointcloud-to-laserscan    </span></span></code></pre></div></div><p>You should already be in the home directory but just in case:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -p ~/catkin_ws/src
</span></span><span class=line><span class=cl><span class=nb>cd</span> ~/catkin_ws/
</span></span><span class=line><span class=cl>ln -s /opt/ros/noetic/share/catkin/cmake/toplevel.cmake src/CMakeLists.txt
</span></span><span class=line><span class=cl>catkin_make
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;source ~/catkin_ws/devel/setup.bash&#34;</span>  &gt;&gt; ~/.bashrc</span></span></code></pre></div></div><p>To test it:</p><p>In three different tabs execute these commands in this order:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>roscore
</span></span><span class=line><span class=cl>rosrun turtlesim turtlesim_node
</span></span><span class=line><span class=cl>rosrun turtlesim turtle_teleop_key</span></span></code></pre></div></div><p>Now your ROS developement environment is fully functioning, so we can just &ldquo;clone&rdquo; the distro to be able to interact in a multihost configuration. Write down your Ubuntu username, it&rsquo;s just the name of the account that we setup in the first step. It also appears before the <code>@</code> in your shell.</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/wsl.conf</span></span></code></pre></div></div><p>Now we have to modify the text file into this:</p><div class=codeblock><div class="codelang codeIcon">conf</div><pre tabindex=0><code class=language-conf data-lang=conf>[boot]
systemd=true
[user]
default=UsernameThatIJustToldYouToWriteDOwn</code></pre></div><p>And now just <code>CTRL + O</code> to save, same name,<code>CTRL + X</code> to exit.</p><h3 id=quality-of-life-improvements-you-can-skip-this><a class="anchor mark-html" href=#quality-of-life-improvements-you-can-skip-this>Quality of life improvements (you can skip this)</a></h3><p>If you want an easier tmux experience with mouse support (like scrolling for output history, click to change pane, etc) and color:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$HOME</span>
</span></span><span class=line><span class=cl>touch ~/.tmux.conf
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;setw -g mouse on&#34;</span> &gt;&gt; ~/.tmux.conf
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;setw -g default-terminal &#34;</span>tmux-256color<span class=s2>&#34;&#34;</span> &gt;&gt; ~/.tmux.conf</span></span></code></pre></div></div><h2 id=cloning><a class="anchor mark-html" href=#cloning>Cloning</a></h2><p>Now create an empty folder in a place of your liking (possibly in a disk with at least 20Gb)</p><p>Open a Powershell terminal in that folder and type:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>powershell</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span> <span class=p>-</span><span class=n>-shutdown</span>
</span></span><span class=line><span class=cl><span class=n>wsl</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-export</span> <span class=n>Ubuntu</span><span class=p>-</span><span class=mf>20.04</span> <span class=n>UbuntuRosBck</span><span class=p>.</span><span class=n>tar</span></span></span></code></pre></div></div><p>Just wait&mldr;.</p><p>If everything went correctly then you can type in the same terminal:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>powershell</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-import</span> <span class=n>UbuntuRosSecondary</span> <span class=p>./</span><span class=n>filesystemsecondary</span> <span class=n>UbuntuRosBck</span><span class=p>.</span><span class=n>tar</span></span></span></code></pre></div></div><p>Wait, again. As soon as the process is complete we can just launch the instance with</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>powershell</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-distribution</span> <span class=n>UbuntuRosSecondary</span> </span></span></code></pre></div></div><p>Now we have two identical WSL instances that we can launch from the start menu or from the terminal drop down.</p><p><figure><picture><source type=image/webp srcset=https://icpmoles.github.io/posts/ros-polimi/finalterm_hu45c08505554f202c10637ae0d4938f78_110506_1440x1000_fit_q95_h2_box_3.webp><source type=image/jpeg srcset="https://icpmoles.github.io/posts/ros-polimi/finalterm_hu45c08505554f202c10637ae0d4938f78_110506_720x500_fit_q75_bgffffff_box_3.jpg 1x, https://icpmoles.github.io/posts/ros-polimi/finalterm_hu45c08505554f202c10637ae0d4938f78_110506_1440x1000_fit_q75_bgffffff_box_3.jpg 2x"><img class=post-img src=https://icpmoles.github.io/posts/ros-polimi/finalterm_hu45c08505554f202c10637ae0d4938f78_110506_720x500_fit_q75_bgffffff_box_3.jpg alt="How your Terminal dropdown should look" loading=lazy width=955 height=574>
</picture><a href=finalterm.png target=_blank class=fullscreen-container aria-label="Fullscreen image"></a><figcaption class=small>How your Terminal dropdown should look</figcaption></figure></p><p>Now, going back to the directory where we exported the backup at the start of this step we have two big files: <code>UbuntuRosBck.tar</code> and <code>filesystem\ext4.vhdx</code></p><blockquote class="notification-boxes notification-warning"><span class=blocktitle>Precaution when moving the generated files pt. 1</span><br><p>For <code>filesystem\ext4.vhdx</code>: DON&rsquo;T TOUCH, MOVE OR DELETE IT. It contains all your data.</p></blockquote><blockquote class="notification-boxes notification-info"><span class=blocktitle>Precaution when moving the generated files pt. 2</span><br><p>For <code>UbuntuRosBck.tar</code> instead you can either delete it or you can also share it with your friends.</p></blockquote><h2 id=sharing-is-caring><a class="anchor mark-html" href=#sharing-is-caring>Sharing is Caring</a></h2><p><code>UbuntuRosBck.tar</code> basically contain a full linux distro with all the ROS packages already installed. You can transfer it on their PC and then in an empty folder just run:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>powershell</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>wsl</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-import</span> <span class=n>UbuntuRosPrimary</span> <span class=p>./</span><span class=n>filesystemprimary</span> <span class=n>UbuntuRosBck</span><span class=p>.</span><span class=py>tar</span>
</span></span><span class=line><span class=cl><span class=n>wsl</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-import</span> <span class=n>UbuntuRosSecondary</span> <span class=p>./</span><span class=n>filesystemsecondary</span> <span class=n>UbuntuRosBck</span><span class=p>.</span><span class=n>tar</span></span></span></code></pre></div></div><p>Ideally this should just run™</p><p>Be mindful to not put anything personal or harmful inside and to give them the password you used in the first step. It&rsquo;s technically a local VM so it shouldn&rsquo;t bee too much of a risk from that point of view.</p><blockquote class="notification-boxes notification-warning"><span class=blocktitle>Just in case it's not clear</span><br><p><strong>Your WSL password, not your Windows password</strong></p></blockquote><p>Also, like for the previous section: please never delete the <code>filesystemprimary\ext4.vhdx</code> and <code>filesystemsecondary\ext4.vhdx</code>files but you can delete <code>UbuntuRosBck.tar</code> file without causing problems.</p><h2 id=testing><a class="anchor mark-html" href=#testing>Testing</a></h2><p>With this configuration you don&rsquo;t have to fiddle with Master IPs and such like for Docker. To test it just run like this:</p><div class=codeblock><div class="codelang terminalIcon" contenteditable=true spellcheck=false>bash</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>roscore
</span></span><span class=line><span class=cl>rosrun turtlesim turtlesim_node
</span></span><span class=line><span class=cl>rosrun turtlesim turtle_teleop_key</span></span></code></pre></div></div><p><figure><picture><source type=image/webp srcset=https://icpmoles.github.io/posts/ros-polimi/image_hu2be0f9ec1c24bda294ca722eb533ce2b_131680_1440x1000_fit_q95_h2_box_3.webp><source type=image/jpeg srcset="https://icpmoles.github.io/posts/ros-polimi/image_hu2be0f9ec1c24bda294ca722eb533ce2b_131680_720x500_fit_q75_bgffffff_box_3.jpg 1x, https://icpmoles.github.io/posts/ros-polimi/image_hu2be0f9ec1c24bda294ca722eb533ce2b_131680_1440x1000_fit_q75_bgffffff_box_3.jpg 2x"><img class=post-img src=https://icpmoles.github.io/posts/ros-polimi/image_hu2be0f9ec1c24bda294ca722eb533ce2b_131680_720x500_fit_q75_bgffffff_box_3.jpg alt="Turtlesim running on multiple machines" loading=lazy width=1915 height=1020>
</picture><a href=image.png target=_blank class=fullscreen-container aria-label="Fullscreen image"></a><figcaption class=small>Turtlesim running on multiple machines</figcaption></figure></p><hr><div><div>Tags:</div><ul><li><a href=../../tags/ubuntu/>Ubuntu</a></li><li><a href=../../tags/ros/>ROS</a></li></ul></div></article></main><footer><p>Copyright 2024. All rights reserved.</p></footer></body></html>